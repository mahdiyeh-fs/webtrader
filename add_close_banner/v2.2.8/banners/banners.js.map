{"version":3,"sources":["../../../../src/banners/banners.es6"],"names":["isEuCountry","clients_country","landing_company","eu_shortcode_regex","RegExp","eu_excluded_regex","financial_shortcode","financial_company","shortcode","gaming_shortcode","gaming_company","test","isMFCountry","mf_shortcode_regex","init","banner","$","$banner","i18n","nav","find","after","go_to_deriv_el","document","getElementById","href","getDerivUrl","showBanner","local_storage","get","liveapi","cached","authorize","then","current_loginId","loginid","getLoginId","loginids","filter","item","id","is_mf_account","is_mf","is_virtual","country","send","data","classList","remove","add","website_status","response","events","on"],"mappings":"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","file":"banners.js","sourcesContent":["import $banner from \"text!./banners.html\";\nimport liveapi from \"../websockets/binary_websockets\";\nimport \"css!banners/banners.css\";\n\nexport const isEuCountry = (clients_country, landing_company) => {\n  const eu_shortcode_regex = new RegExp(\"^(maltainvest|malta|iom)$\");\n  const eu_excluded_regex = new RegExp(\"^mt$\");\n  const financial_shortcode =\n    (landing_company && landing_company.financial_company)\n      ? landing_company.financial_company.shortcode\n      : \"\";\n  const gaming_shortcode =\n    (landing_company && landing_company.gaming_company)\n      ? landing_company.gaming_company.shortcode\n      : \"\";\n\n  return financial_shortcode || gaming_shortcode\n    ? eu_shortcode_regex.test(financial_shortcode) ||\n        eu_shortcode_regex.test(gaming_shortcode)\n    : eu_excluded_regex.test(clients_country);\n};\n\nexport const isMFCountry = (landing_company) => {\n  const mf_shortcode_regex = new RegExp(\"^(maltainvest)$\");\n  const gaming_shortcode =\n  (landing_company && landing_company.gaming_company)\n    ? landing_company.gaming_company.shortcode\n    : \"\";\n\n    return gaming_shortcode \n    ? mf_shortcode_regex.test(gaming_shortcode) \n    : false;\n}\n\nexport const init = () => {\n  const banner = $($banner).i18n();\n  const nav = $(\"body\").find(\"nav\");\n  nav.after(banner);\n  const go_to_deriv_el = document.getElementById(\"close_banner_btn_iom\");\n  go_to_deriv_el.href = getDerivUrl(\"\");\n  showBanner();\n};\n\nconst showBanner = () => {\n  const banner = document.getElementById(\"close_banner_container\");\n  if (local_storage.get(\"oauth\")) {\n    liveapi.cached.authorize().then(() => {\n      const current_loginId =  local_storage.get('authorize').loginid;\n      const getLoginId = loginids().filter( item => item.id === current_loginId);\n      const is_mf_account = getLoginId[0].is_mf;\n      const is_virtual = getLoginId[0].is_virtual;\n      const country = local_storage.get(\"authorize\").country;\n      liveapi.send({ landing_company: country }).then((data) => {\n        const landing_company = data.landing_company;\n        if (isEuCountry(country, landing_company) && \n        (is_mf_account || (isMFCountry(landing_company) && is_virtual))) {\n          banner.classList.remove(\"invisible\");\n        } else {\n          banner.classList.add(\"invisible\");\n        }\n      });\n    });\n  } else {\n    liveapi.send({ website_status: 1 }).then((data) => {\n      const country = data.website_status.clients_country;\n      liveapi.send({ landing_company: country }).then((response) => {\n        const landing_company = response.landing_company;\n        if (isEuCountry(country, landing_company)) {\n          banner.classList.remove(\"invisible\");\n        } else {\n          banner.classList.add(\"invisible\");\n        }\n      });\n    });\n  }\n};\n\nliveapi.events.on(\"login\", () => {\n  showBanner();\n});\nliveapi.events.on(\"logout\", () => {\n  showBanner();\n});\nliveapi.events.on(\"switch_account\", () => {\n  showBanner()\n});\n\nexport default {\n  init,\n  isEuCountry\n};\n"]}