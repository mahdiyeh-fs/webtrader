{"version":3,"sources":["../../../../src/banners/banners.es6"],"names":["isEuCountry","clients_country","landing_company","eu_shortcode_regex","RegExp","eu_excluded_regex","financial_shortcode","financial_company","shortcode","gaming_shortcode","gaming_company","test","init","banner","$","$banner","i18n","nav","find","after","go_to_deriv_el","document","getElementById","href","getDerivUrl","showBanner","local_storage","get","liveapi","cached","authorize","then","country","send","data","classList","remove","add","website_status","response","events","on"],"mappings":";;;;;;;;;;;;;;;;;;AAIO,MAAMA,oCAAc,SAAdA,WAAc,CAACC,eAAD,EAAkBC,eAAlB,EAAsC;AAC/D,QAAMC,qBAAqB,IAAIC,MAAJ,CAAW,2BAAX,CAA3B;AACA,QAAMC,oBAAoB,IAAID,MAAJ,CAAW,MAAX,CAA1B;AACA,QAAME,sBACHJ,mBAAmBA,gBAAgBK,iBAApC,GACIL,gBAAgBK,iBAAhB,CAAkCC,SADtC,GAEI,EAHN;AAIA,QAAMC,mBACHP,mBAAmBA,gBAAgBQ,cAApC,GACIR,gBAAgBQ,cAAhB,CAA+BF,SADnC,GAEI,EAHN;;AAKA,WAAOF,uBAAuBG,gBAAvB,GACHN,mBAAmBQ,IAAnB,CAAwBL,mBAAxB,KACEH,mBAAmBQ,IAAnB,CAAwBF,gBAAxB,CAFC,GAGHJ,kBAAkBM,IAAlB,CAAuBV,eAAvB,CAHJ;AAID,GAhBM;;AAkBA,MAAMW,sBAAO,SAAPA,IAAO,GAAM;AACxB,QAAMC,SAASC,EAAEC,iBAAF,EAAWC,IAAX,EAAf;AACA,QAAMC,MAAMH,EAAE,MAAF,EAAUI,IAAV,CAAe,KAAf,CAAZ;AACAD,QAAIE,KAAJ,CAAUN,MAAV;AACA,QAAMO,iBAAiBC,SAASC,cAAT,CAAwB,sBAAxB,CAAvB;AACAF,mBAAeG,IAAf,GAAsBC,YAAY,EAAZ,CAAtB;AACAC;AACD,GAPM;;AASP,MAAMA,aAAa,SAAbA,UAAa,GAAM;AACvB,QAAMZ,SAASQ,SAASC,cAAT,CAAwB,wBAAxB,CAAf;AACA,QAAII,cAAcC,GAAd,CAAkB,OAAlB,CAAJ,EAAgC;AAC9BC,kCAAQC,MAAR,CAAeC,SAAf,GAA2BC,IAA3B,CAAgC,YAAM;AACpC,YAAMC,UAAUN,cAAcC,GAAd,CAAkB,WAAlB,EAA+BK,OAA/C;AACAJ,oCAAQK,IAAR,CAAa,EAAE/B,iBAAiB8B,OAAnB,EAAb,EAA2CD,IAA3C,CAAgD,UAACG,IAAD,EAAU;AACxD,cAAMhC,kBAAkBgC,KAAKhC,eAA7B;AACA,cAAIF,YAAYgC,OAAZ,EAAqB9B,eAArB,CAAJ,EAA2C;AACzCW,mBAAOsB,SAAP,CAAiBC,MAAjB,CAAwB,WAAxB;AACD,WAFD,MAEO;AACLvB,mBAAOsB,SAAP,CAAiBE,GAAjB,CAAqB,WAArB;AACD;AACF,SAPD;AAQD,OAVD;AAWD,KAZD,MAYO;AACLT,kCAAQK,IAAR,CAAa,EAAEK,gBAAgB,CAAlB,EAAb,EAAoCP,IAApC,CAAyC,UAACG,IAAD,EAAU;AACjD,YAAMF,UAAUE,KAAKI,cAAL,CAAoBrC,eAApC;AACA2B,oCAAQK,IAAR,CAAa,EAAE/B,iBAAiB8B,OAAnB,EAAb,EAA2CD,IAA3C,CAAgD,UAACQ,QAAD,EAAc;AAC5D,cAAMrC,kBAAkBqC,SAASrC,eAAjC;AACA,cAAIF,YAAYgC,OAAZ,EAAqB9B,eAArB,CAAJ,EAA2C;AACzCW,mBAAOsB,SAAP,CAAiBC,MAAjB,CAAwB,WAAxB;AACD,WAFD,MAEO;AACLvB,mBAAOsB,SAAP,CAAiBE,GAAjB,CAAqB,WAArB;AACD;AACF,SAPD;AAQD,OAVD;AAWD;AACF,GA3BD;;AA6BAT,8BAAQY,MAAR,CAAeC,EAAf,CAAkB,OAAlB,EAA2B,YAAM;AAC/BhB;AACD,GAFD;AAGAG,8BAAQY,MAAR,CAAeC,EAAf,CAAkB,QAAlB,EAA4B,YAAM;AAChChB;AACD,GAFD;;oBAIe;AACbb,cADa;AAEbZ;AAFa,G","file":"banners.js","sourcesContent":["import $banner from \"text!./banners.html\";\nimport liveapi from \"../websockets/binary_websockets\";\nimport \"css!banners/banners.css\";\n\nexport const isEuCountry = (clients_country, landing_company) => {\n  const eu_shortcode_regex = new RegExp(\"^(maltainvest|malta|iom)$\");\n  const eu_excluded_regex = new RegExp(\"^mt$\");\n  const financial_shortcode =\n    (landing_company && landing_company.financial_company)\n      ? landing_company.financial_company.shortcode\n      : \"\";\n  const gaming_shortcode =\n    (landing_company && landing_company.gaming_company)\n      ? landing_company.gaming_company.shortcode\n      : \"\";\n\n  return financial_shortcode || gaming_shortcode\n    ? eu_shortcode_regex.test(financial_shortcode) ||\n        eu_shortcode_regex.test(gaming_shortcode)\n    : eu_excluded_regex.test(clients_country);\n};\n\nexport const init = () => {\n  const banner = $($banner).i18n();\n  const nav = $(\"body\").find(\"nav\");\n  nav.after(banner);\n  const go_to_deriv_el = document.getElementById(\"close_banner_btn_iom\");\n  go_to_deriv_el.href = getDerivUrl(\"\");\n  showBanner();\n};\n\nconst showBanner = () => {\n  const banner = document.getElementById(\"close_banner_container\");\n  if (local_storage.get(\"oauth\")) {\n    liveapi.cached.authorize().then(() => {\n      const country = local_storage.get(\"authorize\").country;\n      liveapi.send({ landing_company: country }).then((data) => {\n        const landing_company = data.landing_company;\n        if (isEuCountry(country, landing_company)) {\n          banner.classList.remove(\"invisible\");\n        } else {\n          banner.classList.add(\"invisible\");\n        }\n      });\n    });\n  } else {\n    liveapi.send({ website_status: 1 }).then((data) => {\n      const country = data.website_status.clients_country;\n      liveapi.send({ landing_company: country }).then((response) => {\n        const landing_company = response.landing_company;\n        if (isEuCountry(country, landing_company)) {\n          banner.classList.remove(\"invisible\");\n        } else {\n          banner.classList.add(\"invisible\");\n        }\n      });\n    });\n  }\n};\n\nliveapi.events.on(\"login\", () => {\n  showBanner();\n});\nliveapi.events.on(\"logout\", () => {\n  showBanner();\n});\n\nexport default {\n  init,\n  isEuCountry\n};\n"]}